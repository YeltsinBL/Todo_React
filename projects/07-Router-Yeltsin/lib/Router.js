import{jsx as _jsx}from"react/jsx-runtime";import{useEffect,useState,Children}from"react";import{EVENTS}from"./consts.js";import{match}from"path-to-regexp";import{getCurrentPath}from"./utils.js";export function Router({children,routers=[],defaultComponent:DefaultComponent=()=>_jsx("h1",{children:"404"})}){const[currentPath,setCurrentPath]=useState(getCurrentPath());useEffect(()=>{const onLocalChange=()=>{setCurrentPath(getCurrentPath())};window.addEventListener(EVENTS.PUSH_STATE,onLocalChange);window.addEventListener(EVENTS.POP_STATE,onLocalChange);return()=>{window.removeEventListener(EVENTS.PUSH_STATE,onLocalChange);window.removeEventListener(EVENTS.POP_STATE,onLocalChange)}},[]);let routeParams={};const routersFromChildren=Children.map(children,({props,type})=>{const{name}=type;const isRoute=name==="Route";return isRoute?props:null});const routeToUse=routers.concat(routersFromChildren).filter(Boolean);const Page=routeToUse.find(({path})=>{if(path===currentPath)return true;const matchUrl=match(path,{decode:decodeURIComponent});const matched=matchUrl(currentPath);if(!matched)return false;routeParams=matched.params;return true})?.Component;return Page?_jsx(Page,{routeParams:routeParams}):_jsx(DefaultComponent,{routeParams:routeParams})}